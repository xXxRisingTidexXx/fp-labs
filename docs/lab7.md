---
title: Лабораторна робота №7
description: Обробка рядків та файлів мовами функціонального програмування
---
## Зміст

* TOC
{:toc}

## Мета

Опанувати теоретичні основи обробки рядків та текстових файлів мовами функціонального програмування та розробити
програми їхньої реалізації.

## Завдання

Записати в текстовий файл рядок алфавітних, цифрових символів, довільну кількість символів '(' та ')', що задається
програмою на функціональній мові програмування. Вивести на екран усі символи, розташовані всередині пари дужок, і
підрахувати їхню кількість. Записати в новий текстовий файл символи, розташовані всередині пари дужок.

## Мова та IDE

В якості мови програмування була обрана [racket](https://racket-lang.org/), оскільки вона є строго функціональною. В
якості середовища розробки було обрано супутній редактор DrRacket.

## Реалізація

Результат роботи програми, окрім виведення в консоль - два текстові файли, з яких один містить безпосередньо текст, а
другий - викоремлені фрагменти з-поміж дужок. Алгоритм екстракції останніх доволі примітивний:

1. У вхідному рядку знаходимо індекси дужок обох напрямків.
2. Об'єднуємо отримані вказівники в послідовні пари.
3. Проходимося кожною парою і дивимося, чи є перший символ відкритою дужкою, а другий - закритою.
4. Через ті пари, що лишилися, добуваємо підрядки зсередини дужок.

```racket
(define (unwrap-parentheses text)
  ; Дана процедура виконує цілу пачку дій - виокремлення підтексту й запис до файлів.
  (define (parenthesis? i)
    ; Цей предикат перевіряє, чи є символ у заданій комірці дужкою.
    (or (eq? (string-ref text i) #\() (eq? (string-ref text i) #\))))
  (let
      ; Збережемо у змінній позиції дужок.
      ((indices (filter parenthesis? (range (string-length text)))))
    (define (conjunct i)
      ; Цей конвертер утворює пару з поточного й наступного індекса дужки.
      (cons (list-ref indices i) (list-ref indices (+ i 1))))
    (define (conjugate? p)
      ; Даний предикат перевіряє, чи є суміжні дужки валідним виразом.
      (and (eq? (string-ref text (car p)) #\() (eq? (string-ref text (cdr p)) #\))))
    (define (unwrap p)
      ; Повертає текст зсередини дужок.
      (substring text (+ (car p) 1) (cdr p)))
    (let
        ; Всі підтексти, що знаходилися в дужках.
        ((spans
          (map unwrap (filter conjugate? (map conjunct (range (- (length indices) 1)))))))
      ; Запис початкового тексту до файлу.
      (with-output-to-file "output1.txt" (lambda () (printf text)) #:exists 'replace)
      ; Запис проміжків до іншого файлу.
      (with-output-to-file
        "output2.txt"
        (lambda () (printf (string-join spans)))
        #:exists 'replace)
      (display "Символів у дужках: ")
      ; Підрахунок чимволів у дужках - сума довжин підтекстів.
      (display (apply + (map string-length spans)))
      (newline)
      (display "Проміжки з дужок:")
      (newline)
      (display spans))))
```

Приклади результатів обчислень:

```racket
> (unwrap-parentheses "Hello, world! I'm a (18 + 20 - 6) and )((((((( (((Hi!) (((Tak!)))")
Символів у дужках: 18
Проміжки з дужок:
(18 + 20 - 6 Hi! Tak!)
```

## Оцінка достовірності

Вміст документу, в який було записано весь текст:

```text
Hello, world! I'm a (18 + 20 - 6) and )((((((( (((Hi!) (((Tak!)))
```

Вміст документу, в який було записано текст зсередини дужок:

```text
18 + 20 - 6 Hi! Tak!
```

## Висновки

Рядки - незмінювані масиви символів, що слугують основним носієм нечислової інформації. Всі дані, що надходять до та
вихоядть з програми, перебувають у вигляді тексту. Мова racket надає функціонал роботи з ними, якого вистачає на
найбільш витончені маніпуляції, такі як пошук, заміна чи виокремлення частини.
